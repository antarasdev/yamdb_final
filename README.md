# Проект YaMDb

![example workflow](https://github.com/GlebOlegovich/yamdb_final/actions/workflows/yamdb_workflow.yml/badge.svg)

## Описание
***YaMDB*** - это открытый API для отзывов, который позволяет пользователям ставить оценки и писать отзывы о произведениях искусства. Этот сервис предоставляет возможность получить доступ к множеству отзывов и оценок на различные категории произведений искусства, таких как фильмы, книги, музыка и многое другое.

С помощью ***YaMDB*** пользователи могут ставить оценки произведениям искусства, выражая свое мнение о них. Кроме того, они могут писать отзывы, в которых описывают свои впечатления от произведения. Это позволяет пользователям делиться своими мыслями и чувствами с другими людьми, а также получать информацию от других пользователей, которые уже оценили произведение.

> ***YaMDB*** предоставляет возможность получить доступ к надежной и актуальной информации об отзывах и оценках на произведениях искусства. Это позволяет пользователям принимать более обоснованные решения при выборе произведения для просмотра или прочтения. Кроме того, сервис помогает пользователям оценить качество произведения и сравнить его с другими произведениями в той же категории.

***YaMDB*** является открытым API, что означает, что любой разработчик может использовать его для создания своего собственного приложения. Это дает возможность создавать новые приложения, которые будут использовать информацию, предоставляемую сервисом, для различных целей. Например, можно создать приложение, которое будет предоставлять пользователю рекомендации на основе его предпочтений и оценок.

> В целом, ***YaMDB*** - это полезный сервис для всех, кто интересуется произведениями искусства. Он предоставляет возможность получить доступ к множеству отзывов и оценок на различные категории произведений искусства, а также позволяет пользователям делиться своими мыслями и чувствами с другими людьми. Кроме того, это открытый API, который может быть использован для создания различных приложений, основанных на информации, предоставляемой сервисом.
### Технологии:
- Django rest_framework
- Django rest_framework_simplejwt
- Django django_filters
- Git
- Docker
- NGINX
- GUNICORN
- POSTGRES

### Как запустить проект
Клонировать репозиторий:
```sh
git git@github.com:babyshitt/infra_sp2.git
```

### Перейдите в директорию infra_sp2\infra и создайте файл .env:
#### Шаблон наполнения файла:
```sh
DB_ENGINE=django.db.backends.postgresql # указываем, что работаем с postgresql
DB_NAME=postgres # имя базы данных
POSTGRES_USER=username # логин для подключения к базе данных
POSTGRES_PASSWORD=password # пароль для подключения к БД (установите свой)
DB_HOST=db # название сервиса (контейнера)
DB_PORT=5432 # порт для подключения к БД
```

## Для запуска приложения в контейнерах перейдите в директорию "infra_sp2\infra" и выполните команды:

```sh
docker-compose up -d --build
```
Выполнить миграции:


```bash
docker-compose exec web python manage.py makemigrations users
docker-compose exec web python manage.py migrate

Для создания суперюзера выполинте команду:
```sh
docker-compose exec web python manage.py createsuperuser
```
Собрать статику:

```bash
docker-compose exec web python manage.py collectstatic --no-input
```

#### Теперь проект готов к работе и доступен по адресу http://localhost/api/v1.
#### И также доступен доступ к админке: http://localhost/admin/login/?next=/admin/.

Для создания резервной копии базы данных выполните команду из директории infra_sp2\infra:
```sh
docker-compose exec web python manage.py dumpdata > fixtures.json
```

И подгрузите данные БД из директории infra\docker-compose.yaml:
```sh
docker-compose exec web python manage.py loaddata fixtures.json
```

#### Руководство к проекту:
##### Пользовательские роли
 - Аноним — может просматривать описания произведений, читать отзывы и комментарии.
 - Аутентифицированный пользователь (user) — может читать всё, как и Аноним, может публиковать отзывы и ставить оценки произведениям (фильмам/книгам/песенкам), может комментировать отзывы; может редактировать и удалять свои отзывы и комментарии, редактировать свои оценки произведений. Эта роль присваивается по умолчанию каждому новому пользователю.
 - Модератор (moderator) — те же права, что и у Аутентифицированного пользователя, плюс право удалять и редактировать любые отзывы и комментарии.
 - Администратор (admin) — полные права на управление всем контентом проекта. Может создавать и удалять произведения, категории и жанры. Может назначать роли пользователям.
 - Суперюзер Django должен всегда обладать правами администратора, пользователя с правами admin. Даже если изменить пользовательскую роль суперюзера — это не лишит его прав администратора.

### Алгоритм регистрации пользователей
 - Пользователь отправляет POST-запрос с параметрами email и username на эндпоинт /api/v1/auth/signup/.
 - Сервис YaMDB отправляет письмо с кодом подтверждения (confirmation_code) на указанный адрес email.
 - Пользователь отправляет POST-запрос с параметрами username и confirmation_code на эндпоинт /api/v1/auth/token/, в ответе на запрос ему приходит token (JWT-токен).
 - В результате пользователь получает токен и может работать с API проекта, отправляя этот токен с каждым запросом.

### Создание пользователя администратором
 - Пользователя может создать администратор — через админ-зону сайта или через POST-запрос на специальный эндпоинт api/v1/users/ (описание полей запроса для этого случая — в документации).
 - - В этот момент письмо с кодом подтверждения пользователю отправлять не нужно.
После этого пользователь должен самостоятельно отправить свой email и username на эндпоинт /api/v1/auth/signup/ , в ответ ему должно прийти письмо с кодом подтверждения.
 - Далее пользователь отправляет POST-запрос с параметрами username и confirmation_code на эндпоинт /api/v1/auth/token/, в ответе на запрос ему приходит token (JWT-токен), как и при самостоятельной регистрации.

 ## Ресурсы сервиса API YaMDb
- auth: аутентификация.
- users: пользователи.
- titles: произведения, к которым пишут отзывы (определённый фильм, книга или песенка).
- categories: категории (типы) произведений («Фильмы», «Книги», «Музыка»).
- genres: жанры произведений. Одно произведение может быть привязано к нескольким жанрам.
- reviews: отзывы на произведения. Отзыв привязан к определённому произведению.
- comments: комментарии к отзывам. Комментарий привязан к определённому отзыву.


---
# Авторы
Андрей Тарасов - GitHub: https://github.com/babyshitt
Эдуард Гумен - GitHub: https://github.com/hydrospirt
Дмитрий Смолов - GitHub: https://github.com/DmitrySmolov
